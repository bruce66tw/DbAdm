function Datatable(n,t,i,r,u,f){this.dt=null;this.findJson=r;this.recordsFiltered=-1;this.defaultShowOk=!0;this._keepStart=!1;this._start=0;this._nowShowOk=this.defaultShowOk;this.resetCount=function(){this.recordsFiltered=-1};this.find=function(n){this.findJson=n;this.resetCount();this.dt.search("").draw(!this._keepStart)};this.reload=function(){this._keepStart=!0;this._nowShowOk=!1;this.find(this.findJson)};this.init=function(n,t,i,r,u){var e={processing:!1,serverSide:!0,jQueryUI:!1,filter:!1,paginate:!0,lengthChange:!0,info:!0,sorting:[],pagingType:"full_numbers",language:{url:"../locale/"+_fun.locale+"/dataTables.txt"},dom:'l<"toolbar">frtip',initComplete:function(){var t,i;u&&$(this).closest(".dataTables_wrapper").find("div.toolbar").html(u);t=$(n+"_filter input");t.length>0&&(t.unbind(),i=this.api(),t.bind("keyup",function(n){n.keyCode===13&&(this.resetCount(),i.search(this.value).draw())}))}.bind(this),ajax:{url:t,type:"POST",dataType:"json",data:function(n){n.findJson=_json.toStr(this.findJson);n.recordsFiltered=this.recordsFiltered;this._keepStart&&(n.start=this._start)}.bind(this),dataSrc:function(n){return this._start=this.dt.page.info().start,this._keepStart=!1,n.ErrorMsg!=null&&n.ErrorMsg!=""?(_tool.msg(n.ErrorMsg),n.recordsFiltered=0,this.recordsFiltered=0,[]):(this.recordsFiltered=n.recordsFiltered,r?r(n):n.data===null||n.data.length===0?(_tool.alert(RB.FindNone,"R"),[]):(this._nowShowOk&&_tool.alert(RB.FindOk),this._nowShowOk=this.defaultShowOk,n.data))}.bind(this),error:function(n,t,i){_tool.hideWait();_tool.msg("Datatable.js error.");n!=null&&(console.log("status"+n.status),console.log(i))}}},f;i&&(e=_json.copy(i,e));f=$(n);f.on("preXhr.dt",function(){_tool.showWait()});f.on("xhr.dt",function(){_tool.hideWait()});this.dt=f.DataTable(e)};this.init(n,t,i,u,f)}function EditMany(n,t,i,r){this.init=function(){this.DataFkeyFid="_fkeyfid";this.kid=n;this.isMulti=!0;this.fileIds=[];var u=$("#"+i);this.tplRow=u.html();this.fidTypes=_edit.getFidTypes($(this.tplRow));this.fidTypeLen=this.fidTypes.length;u.find(":file").each(function(n){this.fileIds[n]=$(this).data("id")});this.hasFile=this.fileIds.length>0;this.hasForm=!_str.isEmpty(t);this.hasForm&&(this.form=$("#"+t),this.rowsBox=this.form.find("tbody"));this.sortFid=r;this.deletedRows=[];this.newIndex=0};this.isNewRow=function(n){return this.isNewKey(n[this.kid])};this.reset=function(){this.newIndex=0;this.deletedRows=[]};this.loadJson=function(n){(this.reset(),n!=null&&n[_crud.Rows]!=null)&&(this.hasForm?this.loadRows(this.rowsBox,n[_crud.Rows]):this.ufLoadJson(n))};this.loadRow=function(n,t,i){var u=$(Mustache.render(this.tplRow,{Index:i})),r,f;for(_form.loadRow(u,t),r=0;r<this.fidTypeLen;r=r+2)fid=this.fidTypes[r],f=_obj.get(fid,u),f.data(_edit.DataOld,t[fid]);n.append(u)};this.loadRows=function(n,t){var e,r,u,f,i,o;if(n.empty(),e=t==null?0:t.length,e!==0)for(r=0;r<e;r++){for(u=t[r],f=$(Mustache.render(this.tplRow,u)),i=0;i<this.fidTypeLen;i=i+2)fid=this.fidTypes[i],o=_obj.get(fid,f),_edit.setOld(o,u[fid]);_form.loadRow(f,u);f.appendTo(n)}};this.valid=function(){return this.hasForm?this.form.valid():this.ufValid()};this.getRow=function(n){for(var i={},t=0;t<this.fidTypeLen;t=t+2)fid=this.fidTypes[t],obj=_obj.get(fid,n),i[fid]=_input.getByType(obj,this.fidTypes[t+1],n);return i};this.getUpdJson=function(n){if(!this.hasForm)return this.ufGetUpdJson();var t={};return t[_crud.Rows]=this.getUpdRowsByArg(n,this.rowsBox),t[_crud.Deletes]=this.getDeletedRows(),t};this.isNewKey=function(n){return n.length<=5};this.getUpdRowsByArg=function(t,i,r){r=r||"tr";this.setSort();var f=[],u=this;return i.find(r).each(function(i,r){var o=$(r),p=_input.get(u.kid,o),h,s,c,l,a,v,y,e;if(u.isNewKey(p)){h=u.getRow(o);h[u.DataFkeyFid]=t;f.push(h);return}for(s={},c=!1,e=0;e<u.fidTypes.length;e=e+2)(a=u.fidTypes[e+1],a!=="label")&&(l=u.fidTypes[e],y=_obj.get(l,o),v=_input.getByType(y,a,o),v!=_edit.getOld(y)&&(s[l]=v,c=!0));c&&(s[n]=p,f.push(s))}),f.length===0?null:f};this.getDeletedRows=function(){return this.deletedRows.length===0?null:this.deletedRows.join()};this.onAddRow=function(){this.addRow()};this.addRow=function(n){if(!this.hasForm)return _log.error("EditMany.js addRow() failed, hasForm is false."),null;n=n||{};var t=this.renderRow(n);return this.boxSetNewId(t),t};this.onDeleteRow=function(n){var t=$(n).closest("tr");this.deleteRow(_iText.get(this.kid,t),t)};this.deleteRow=function(n,t){for(var i=this.deletedRows,u=!1,f=i.length,r=0;r<f;r++)if(i[r][this.kid]===n){u=!0;break}u||(i[f]=n);t.remove()};this.renderRow=function(n){if(!this.hasForm)return null;var t=$(Mustache.render(this.tplRow,n));return t.appendTo(this.rowsBox),t};this.dataAddFiles=function(n,t){if(this.fileLen!==0){var i={};this.rowsBox.find("tr").each(function(r,u){for(var f,o,s=$(u),e=0;e<this.fileLen;e++)f=this.fileIds[e],o=_edit.getFileServerId(n,f),_iFile.dataAddFile(t,f,o,this.form)&&(i[f]=i[f]==null?0:i[f]+1,t.append("_"+o+i[f],s.data(_key)))})}};this.zz_boxLoadData=function(n){var i=n==null?0:n.length,t;for(this.rowsBox.empty(),t=0;t<i;t++)this.rowsBox.append(Mustache.render(this.tplRow,n[t]));this.newIndex=0;this.deletedRows=[]};this.onChangeFile=function(n){if(n.files[0].size>_fun.maxFileSize){_tool.msg("上傳檔案不可大於50M !");n.value="";return}var t=$(n).closest("tr");t.data("fun")===""&&t.data("fun",_fun.ModeU)};this.rowSetMapId=function(n,t){n!=null&&this.isNewRow(n)&&(n[this.DataFkeyFid]=t)};this.rowsSetMapId=function(n,t){var i,r;if(n!=null)for(i=0;i<n.length;i++)r=n[i],r!=null&&this.isNewRow(r)&&(r[this.DataFkeyFid]=t)};this.boxSetNewId=function(n){this.newIndex++;_iText.set(this.kid,this.newIndex,n)};this.setSort=function(){var n=this.sortFid;_str.isEmpty(n)||this.rowsBox.find("tr").each(function(t,i){_iText.set(n,t,$(i))})};this.init()}function EditOne(n,t){this.init=function(){this.kid=n||"Id";this.form=$("#"+(t||"formEdit"));this.isMulti=!1;this.fidTypes=_edit.getFidTypes(this.form);this.fidTypeLen=this.fidTypes.length;this.fileIds=[];this.form.find(":file").each(function(n){this.fileIds[n]=$(this).attr("id")});this.fileLen=this.fileIds.length;this.hasFile=this.fileLen>0};this.getKey=function(){return _input.get(this.kid,this.form)};this.isNewRow=function(){return _str.isEmpty(this.getKey())};this.loadRow=function(n){var t,i;for(_form.loadRow(this.form,n),t=0;t<this.fidTypeLen;t=t+2)fid=this.fidTypes[t],i=_obj.get(fid,this.form),i.data(_edit.DataOld,n[fid])};this.getUpdRow=function(){return _edit.getUpdRow(this.kid,this.fidTypes,this.form)};this.reset=function(){_form.reset(this.form)};this.setEdit=function(n){_form.setEdit(this.form,n)};this.dataAddFiles=function(n,t){for(var i=0;i<this.fileLen;i++)_iFile.dataAddFile(t,this.fileIds[i],_edit.getFileServerId(n,this.fileIds[i]),this.form)};this.onFile=function(){};this.onOpenFile=function(){};this.onViewFile=function(){};this.onDeleteFile=function(){};this.init()}var _ajax={getJson:function(n,t,i,r){var u={url:n,type:"POST",data:t,dataType:"json"};_ajax._call(u,i,r)},getJsonByFormData:function(n,t,i,r){var u={url:n,type:"POST",cache:!1,data:t,contentType:!1,dataType:"json",processData:!1};_ajax._call(u,i,r)},getStr:function(n,t,i,r){var u={url:n,type:"POST",data:t,dataType:"text"};_ajax._call(u,i,r)},getView:function(n,t,i,r){var u={url:n,type:"POST",data:t,dataType:"html"};_ajax._call(u,i,r)},file:function(n,t,i,r,u){var f=new FormData,e;f.append(t,i);e={url:n,type:"POST",data:f,dataType:"text",cache:!1,contentType:!1,processData:!1};_ajax._call(e,r,u)},_call:function(n,t,i){var r={success:function(n){n&&n.ErrorMsg?i==null?_tool.msg(n.ErrorMsg):i(n):t&&t(n)},error:function(n,t,i){n!=null&&(console.log("status"+n.status),console.log(i))},beforeSend:function(){_tool.showWait()},complete:function(){_tool.hideWait()}};$.ajax(_json.copy(n,r))}},_array={find:function(n,t){if(n==null)return-1;for(var i=0;i<n.length;i++)if(n[i]==t)return i;return-1},toStr:function(n,t){return t=t||",",n.join(t)}},_assert={echo:function(n){_error.log("_assert.js "+n)},inArray:function(n,t){var i=!1;for(var r in t)if(r==n){i=!0;break}i||_assert.echo("inArray failed: "+n)}},_browser={_langCode:"_langCode",pushState:function(n){history.pushState(null,null,n)},zz_print:function(n,t,i){_browser.printO(_obj.getById(n,t,i))},zz_printO:function(){window.print()}},_btn={setEdit:function(n,t,i){_btn.setEditO(_obj.getById(n,i),t)},setEditO:function(n,t){n.prop("disabled",!t)},setEditF:function(n,t,i){_btn.setEditO(_obj.getF(n,i),t)}},_chart={rainbowColors:["#F32E37","#EABE37","#89E926","#22E352","#2FE5E8","#295AE7","#8828EE","#E629B7",],initPie:function(n,t,i,r,u){var f={type:"pie",options:{legend:{position:"right",labels:{boxWidth:10}}},data:{labels:t,datasets:[{data:i,backgroundColor:r,borderWidth:1}]}};return u&&(f=_json.copy(u,f)),new Chart(n,f)}},_crud={Rows:"_rows",Childs:"_childs",Deletes:"_deletes",Create:"C",Update:"U",View:"V",temp:{},dtDom:'<"toolbar">t<li>p',dtColConfig:{className:"xg-center",orderable:!1,targets:"_all"},dtCheck0:function(n,t,i){return t===undefined&&(t=!0),i=i||_iCheck.check0Id,_iCheck.render2(0,i,n,!1,"",t)},dtRadio1:function(n,t){return t===undefined&&(t=!0),_iRadio.render(_iCheck.check0Id,"",!1,n,t)},dtSetStatus:function(){return""},dtCrudFun:function(n,t,i,r,u){var f="";return i&&(f+=_str.format('<a onclick="_crud.onUpdate(\'{0}\');"><i class="icon-pen" title="{1}"><\/i><\/a>',n,RB.TipUpdate)),r&&(f+=_str.format('<a onclick="_crud.onDelete(\'{0}\',\'{1}\');"><i class="icon-times" title="{2}"><\/i><\/a>',n,t,RB.TipDelete)),u&&(f+=_str.format('<a onclick="_crud.onView(\'{0}\');"><i class="icon-eye" title="{1}"><\/i><\/a>',n,RB.TipView)),f},init:function(n,t){var u=_crud.Childs,i=null,r;if(t==null)i=new EditOne;else if(i=t[0]===null?new EditOne:t[0],t.length>1)for(i[u]=[],r=1;r<t.length;r++)i[u][r-1]=t[r];_me.nowFun="";_me.divRead=$("#divRead");_me.divEdit=$("#divEdit");_me.formFind=$("#formFind");_me.formFind2=$("#formFind2");_me.formFind2.length===0&&(_me.formFind2=null);_me.edit=i;_me.hasChild=_fun.notNull(_me.edit[u])&&_me.edit[u].length>0;_crud.initForm(_me.edit);_me.modal=null;_me.dt=new Datatable("#table1","GetPage",n);_prog.init()},initForm:function(n){var i,t;if(n.form!=null)for(_iDate.init("",n.form),_valid.init(n.form),i=_crud.getEditChildLen(n),t=0;t<i;t++)_crud.initForm(_crud.getEditChild(n,t))},getForm0:function(){return _me.edit.form},onFind2:function(){var n=_me.formFind2;n!=null&&(_obj.isShow(n)?_form.hideShow([n]):_form.hideShow(null,[n]))},getFindCond:function(){var t=_form.toJson(_me.formFind),n=_me.formFind2;return n!==null&&_obj.isShow(n)&&_json.copy(_form.toJson(n),t),t},onFind:function(){var n=_crud.getFindCond();_me.dt.find(n)},onExport:function(){var n=_crud.getFindCond();window.location="Export?cond="+_json.toStr(n)},onToRead:function(){_crud.toReadMode()},onCreate:function(){_me.key="";_crud.setEditStatus(_crud.Create);_prog.setPathCreate();_crud.resetForm(_me.edit);_form.swap(_me.divEdit)},onUpdate:function(n){_crud.getJsonAndSetMode(n,_crud.Update)},onView:function(n){_crud.getJsonAndSetMode(n,_crud.View)},getJsonAndSetMode:function(n,t){if(_str.isEmpty(n)){_log.error("error: key is empty !");return}_ajax.getJson("GetJson",{key:n},function(i){_crud.loadJson(i);_me.key=n;_prog.setPathUpdate();_crud.setEditStatus(t);_form.swap(_me.divEdit)})},setEditStatus:function(n){var t=n==_crud.View,r=_me.nowFun==_crud.View&&!t?!0:_me.nowFun!=_crud.View&&t?!0:!1,i;_me.nowFun=n;r&&(i=_me.divEdit,i.find("input, textarea, select, button").prop("disabled",t),t&&i.find("#btnToRead").prop("disabled",!1))},onSetStatus:function(n,t){var i=_iCheck.checkedO($(n));_ajax.getStr("SetStatus",{key:t,status:i},function(){_tool.alert(RB.UpdateOk)})},loadJson:function(n){var t=_me.edit,r,i,u;for(t.loadRow(n),r=_crud.getEditChildLen(t),i=0;i<r;i++)u=_crud.getEditChild(t,i),u.loadJson(_crud.getChildJson(n,i));_fun.notNull(t.ufAfterLoadJson)&&t.ufAfterLoadJson(n)},getUpdJson:function(n){var t=_me.edit,e=t.getUpdRow(),l=t.getKey(),o="0",i,c,f,r,u;t.hasFile&&t.dataAddFiles(o,n);var s=!1,h=[],a=_crud.getEditChildLen(t);for(i=0;i<a;i++)(c=_crud.getEditChild(t,i),f=_crud.getChildUpdJson(l,o+i,n,c),f!=null)&&(s=!0,h[i]=f);return r={},u=!1,e!=null&&(u=!0,r[_crud.Rows]=[e]),s&&(u=!0,r[_crud.Childs]=h),u?(_crud._removeNull(0,r),r):null},getChildUpdJson:function(n,t,i,r){var u=r.getUpdJson(n);return r.hasFile&&r.dataAddFiles(t,i),u},getEditChildLen:function(n){var t=_crud.Childs;return n[t]==null?0:n[t].length},getEditChild:function(n,t){return n[_crud.Childs][t]},getJsonRows:function(n){return n==null||n[_crud.Rows]==null?null:n[_crud.Rows]},getChildJson:function(n,t){var i=_crud.Childs;return n[i]==null||n[i].length<=t?null:n[i][t]},getChildRows:function(n,t){var i=_crud.getChildJson(n,t);return _crud.getJsonRows(i)},setChildRows:function(n,t,i){var r=_crud.Childs,u;return n==null&&(n={}),n[r]==null&&(n[r]=[]),n[r].length<=t&&(n[r][t]={}),u=n[r][t],u[_crud.Rows]=i,u},validAll:function(){var t=_me.edit,i,n,r;if(!t.form.valid())return!1;for(i=_crud.getEditChildLen(t),n=0;n<i;n++)if(r=_crud.getEditChild(t,n),!r.valid())return!1;return!0},onSave:function(){var t;if(!_crud.validAll()){_tool.alert(RB.InputWrong);return}if(_fun.notNull(_me.edit.ufWhenSave)&&(t=_me.edit.ufWhenSave(),t!="")){_tool.msg(t);return}var i=new FormData,r=_crud.getUpdJson(i),n=null;_crud.hasFile?(n=i,n.append("json",_json.toStr(r)),_ajax.getJsonByFormData("Save",n,function(n){_crud.afterSave(n)})):(n={json:_json.toStr(r)},_ajax.getJson("Save",n,function(n){_crud.afterSave(n)}))},_removeNull:function(n,t){$.each(t,function(i,r){var f,e,u;if(r===null)delete t[i];else if(_json.isKeyValue(r))_crud._removeNull(n+1,r);else if($.isArray(r)){for($.each(r,function(t,i){_crud._removeNull(n+1,i);_json.isEmpty(i)&&(i=null)}),f=!0,e=r.length,u=e-1;u>=0;u--)_json.isEmpty(r[u])?f?delete r[u]:r[u]=null:f=!1;f&&delete t[i]}})},afterSave:function(n){if(_fun.notNull(_me.edit.ufAfterSave)&&_me.edit.ufAfterSave(),n.Value==="0"){_tool.msg(RB.SaveNone);return}var t=_me.dt.dt.page.info().start;_tool.alert(RB.SaveOk+"("+n.Value+")");_me.dt.reload();_crud.toReadMode()},onCheckAll:function(n,t,i){_iCheck.setF("[data-id="+i+"]:not(:disabled)",_iCheck.checkedO($(n)),t)},onDelete:function(n,t){_crud.temp.data={key:n};_tool.ans(RB.SureDeleteRow+" ("+t+")",function(){_ajax.getStr("Delete",{key:n},function(){_tool.alert(RB.DeleteOk);_me.dt.reload()})})},onDeleteRows:function(n,t){var i=_iCheck.getCheckedValues(n,t);if(i.length===0){_tool.msg(RB.PlsSelectDeleted);return}_crud.temp.data={keys:i};_tool.ans(RB.SureDeleteSelected,function(){_ajax.getStr("DeleteByKeys",_crud.temp.data,function(){_tool.alert(RB.DeleteOk);_me.dt.reload()})})},onOpenModal:function(n,t,i){var r=$(n).closest("tr"),u=_iText.get(i,r);_tool.showArea(t,u,function(n){_iText.set(i,n,r)})},_keysToStr:function(n){for(var i=[],t=0;t<n.length;t++)i[t]=n[t].length===0?"":n[t].join(_fun.RowSep);return i.join(_fun.TableSep)},resetForm:function(n){for(var i=_crud.getEditChildLen(n),t=0;t<i;t++)_crud.resetForm(_crud.getEditChild(n,t))},toReadMode:function(){_prog.resetPath();_form.swap(_me.divRead)}},_edit={DataOld:"_old",getOld:function(n){return n.data(_edit.DataOld)},setOld:function(n,t){n.data(_edit.DataOld,t)},getUpdRow:function(n,t,i){var c=_input.get(n,i),f,u,e,o,s,h,r;if(_str.isEmpty(c))return _form.toJson(i);for(f=!1,u={},r=0;r<t.length;r=r+2)(o=t[r+1],o!=="label")&&(e=t[r],h=_obj.get(e,i),s=_input.getByType(h,o,i),s!=h.data(_edit.DataOld)&&(u[e]=s,f=!0));return f?(u[n]=c,u):null},getFidTypes:function(n){var t=[];return n.find("[name]").each(function(n,i){var r=$(i),u=n*2;t[u]=r.attr("name");t[u+1]=_input.getType(r)}),t},getFileServerId:function(n,t){return"t"+n+"_"+t}},_error={log:function(n){console.log(n)}},_form={toJson:function(n){var i="name",u=n.serializeArray(),t={},r;return $.each(u,function(){t[this.name]=this.value||""}),n.find(":checkbox").each(function(){var r=$(this),n=r.attr(i);_fun.notNull(n)&&n.indexOf("-")<0&&(t[n]=_iCheck.getO(r))}),r="["+i+"]:radio",n.find(r).each(function(){var u=$(this),r=u.attr(i);t[r]=_iRadio.get(r,n)}),t},toJsonStr:function(n){return JSON.stringify(_form.toJson(n))},loadRow:function(n,t){for(var i in t)_input.set(i,t[i],n)},reset:function(n){n.find("[name]").each(function(){_input.setO($(this),"",n)})},hasFile:function(n){return n.find(":file").length>0},getSaveData:function(n,t,i,r,u){return{isNew:n,key:t,row:_json.toStr(i),rows:_json.toStr(r),deletes:_form.keysToStr(u)}},getSaveDataWithFiles:function(n,t,i,r,u){var e,f,o,s;for(r=r||[],u=u||[],e=new FormData,e.append("isNew",n),f=0;f<r.length;f++)_iFile.rowAddFile(e,i,r[f][0],r[f][1],t);for(o=[i],s=[],f=0;f<u.length;f++)_editMany.dataAddRows(e,o,u[f]),s[f]=u[f].deletes;return e.append("rows",_json.toStr(o)),e.append("deletes",_editMany.keysToStr(s)),e},setEdit:function(n,t){_iText.setEditO(n.find("input:text"),t);_iTextarea.setEditO(n.find("textarea"),t);_iDate.setEditO(n.find(".xd-date"),t);_iSelect.setEditO(n.find("select"),t);_iCheck.setEditO(n.find(":checkbox"),t);_iRadio.setEditO(n.find(":radio"),t);_btn.setEditO(n.find("button"),t)},hideShow:function(n,t){var r,i,u;if(n)for(i=0;i<n.length;i++)r=n[i],r.fadeOut(500,function(){r.hide()});if(t)for(i=0;i<t.length;i++)u=t[i],u.fadeIn(500,function(){u.show()})},swap:function(n){var t=$(".xg-swap.xg-active");n!==t&&t.fadeOut(200,function(){t.removeClass("xg-active");n.addClass("xg-active");n.fadeIn(500)})},zz_reset:function(n){n.find("input:text").val("")}},RB=null,_fun={locale:"zh-TW",jsPath:"../Scripts/",inputBoxCls:"xg-error",errCls:"xg-error",errLabCls:"xg-error-label",xdRequired:"xd-required",ModeC:"C",ModeR:"R",ModeU:"U",TableSep:":",RowSep:";",ColSep:",",maxFileSize:50971520,data:{},isCheck:!0,onHello:function(){_ajax.getStr("../Fun/Hello",null,function(){alert("OK")})},"default":function(n,t){return n==null?t:n},notNull:function(n){return!(n==null)},onSetLocale:function(n){_ajax.getStr("../Fun/SetLocale",{code:n},function(){location.reload()})},xgTextBoxValid:function(n,t){var i=n.parentNode;t==""?n.value!=""?n.parentNode.classList.remove("xg-error"):(n.parentNode.classList.add("xg-error"),_fun.isCheck=!1):n.value.match(new RegExp(t))!=null?n.parentNode.classList.remove("xg-error"):(n.parentNode.classList.add("xg-error"),_fun.isCheck=!1)},xgCheckfn:function(){var i,t,n;for(_fun.isCheck=!0,i=document.getElementsByClassName("xg-textbox"),n=0;n<i.length;n++)i[n].childNodes[1].onchange();for(t=document.getElementsByClassName("xg-select"),n=0;n<t.length;n++)t[n].childNodes[1].value==0||t[n].childNodes[1].value==""?(t[n].classList.add("xg-error"),_fun.isCheck=!1):t[n].classList.remove("xg-error");return _fun.isCheck},zz_onChangeMultiCheck:function(n,t){var r=$("#"+t),i="",u="",e=r.attr("data-separator"),f=r.attr("data-onclick");$(r.parent()).find("input:checked").each(function(){i+=$(this).val()+e;u+=$(this).text()+","});i!=""&&(i=i.substring(0,i.length-1),u=u.substring(0,u.length-1));r.attr("title",u);r.val(i);f!=undefined&&f!=""&&f(n,$(n).val())}},_helper={getBaseProp:function(n,t,i,r,u,f,e){var o=_str.format("type='{0}' data-id='{1}' name='{2}' value='{3}'",r,t,t+n,i);return u===!0&&(o+=" required"),f===!1&&(o+=" readonly"),_str.isEmpty(e)||(o+=" "+e),_str.trim(o)}},_iBase={get:function(n,t){return _iBase.getO(_obj.get(n,t))},getF:function(n,t){return _iBase.getO(_obj.getF(n,t))},getO:function(n){return n.val()},set:function(n,t,i){_iBase.setO(_obj.get(n,i),t)},setF:function(n,t,i){_iBase.setO(_obj.getF(n,i),t)},setO:function(n,t){n.val(t)},setEdit:function(n,t,i){_iBase.setEditO(_obj.get(n,i),t)},setEditF:function(n,t,i){_iBase.setEditO(_obj.getF(n,i),t)},setEditO:function(n,t){n.prop("readonly",!t)}},_iCheck=$.extend({},_iBase,{check0Id:"_check0",getO:function(n){return n.is(":checked")?n.val():"0"},setO:function(n,t){var i=t=="1"||t=="True"||t==!0;n.prop("checked",i)},setEditO:function(n,t){n.prop("disabled",!t)},checked:function(n,t){return _iCheck.checkedO(_obj.get(n,t))},checkedF:function(n,t){return _iCheck.checkedO(_obj.getF(n,t))},checkedO:function(n){return n.is(":checked")},dtCheck0:function(n,t){_str.isEmpty(n)&&(n=1);var i="name='"+_iCheck.check0Id+"' value='"+n+"'";return t&&(i+=" checked"),"<label class='xg-check xg-no-label'>   <input "+i+" type='checkbox'>   <span><\/span><\/label>"},getCheckedValues:function(n,t){t=t||_iCheck.check0Id;var i=[];return _obj.getF("[name="+t+"]:checked",n).each(function(n){i[n]=this.value}),i},setCheckedByJsons:function(n,t,i){var r,u;if(!_str.isEmpty(t))for(i=i||_iCheck.check0Id,r=0;r<t.length;r++)u=n.find("[value="+t[r][i]+"]"),_iCheck.setO(u,1)}}),_iColor={init:function(){$(".xg-color").colorpicker({})},get:function(n,t){return _iColor.getO(_obj.get(n,t))},getF:function(n,t){return _iColor.getO(_obj.getF(n,t))},getO:function(n){return _iColor.rgbToHex(n.find("i").css("background-color"))},rgbToHex:function(n){var i=n.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),t;for(delete i[0],t=1;t<=3;++t)i[t]=parseInt(i[t]).toString(16),i[t].length==1&&(i[t]="0"+i[t]);return"#"+i.join("")}},_iDate=$.extend({},_iBase,{getO:function(n){return n.val()},setO:function(n,t){n.val(_iDate.toDate(t))},setEditO:function(n,t){n.prop("disabled",!t)},init:function(n,t){var i=_str.isEmpty(n)?$(".xg-date"):_obj.get(n,t).closet(".xg-date");i.length>0&&_iDate.initO(i)},initO:function(n){n.datepicker({language:_fun.locale,autoclose:!0,showOnFocus:!1}).on("changeDate",function(){});n.find(".input-group-addon").off("click")},initByBox:function(n,t){_iDate.initO(n.find(".xg-date"),t)},toggle:function(n){$(n).parent().parent().datepicker("show")},clean:function(n){$(n).parent().parent().datepicker("update","")},render:function(n,t,i,r){return r=r||"",i===!0&&(r+=" "+_fun.xdRequired),_str.format("<div class='input-group date xg-date' data-provide='datepicker'>    <input data-id='{0}' value='{1}' type='text' class='form-control xd-date {2}'>    <div class='input-group-addon'>        <i class='fa fa-times' onclick='_iDate.clean(this)'><\/i>        <i class='fa fa-calendar' onclick='_iDate.toggle(this)'><\/i>    <\/div><\/div><span data-id2='{3}' class='{4}'><\/span>",n,_iDate.toDate(t),r,n+_fun.errTail,_fun.errLabCls)},getStartEnd:function(){},today:function(){var n=new Date;return n.getFullYear()+"/"+(n.getMonth()+1)+"/"+n.getDate()},getYear:function(){return(new Date).getFullYear()},toDate:function(n){return _str.isEmpty(n)?"":moment(n).format(RB.DateEditFormat)},toDt2:function(n){return _str.isEmpty(n)?"":moment(n).format(RB.DtFormat2)},getDt:function(n,t,i){var r=_iDate.get(n,i),u=_iSelect.get(t,i);return r==""?"":u==""?r:r+" "+u},field3ToDt:function(n,t,i,r){var e=_iDate.get(n,r),u,f;return e==""?"":(u=_iSelect.get(t,r),f=_iSelect.get(i,r),e+" "+(u==""?"00":u)+":"+(f==""?"00":f))},isBig:function(n,t){return Date.parse(n)>Date.parse(t)},getMonthDiff:function(n,t){return _str.isEmpty(n)||_str.isEmpty(t)?0:_iDate.getMonthDiffByDate(new Date(n),new Date(t))},getMonthDiffByDate:function(n,t){return(t.getFullYear()-n.getFullYear())*12+t.getMonth()-n.getMonth()+1},addYear:function(n,t){return parseInt(n.substring(0,4))+t+n.substring(4)}}),_iFile={init:function(n,t,i){var r=_obj.getF(_iFile.fileF(n),i);r.val("");r.data("fun","");_iFile.setPath(n,t,i)},fileF:function(n){return"[name="+n+"]"},labelF:function(n){return".xd-"+n+"-url"},setPath:function(n,t,i){var r=_obj.getF(_iFile.labelF(n),i),u=r.find("a"),f=_iFile.getFileName(t);u.text(f);u.attr("href",t);_str.isEmpty(f)?r.hide():r.show()},_getFileAfter:function(n,t){var i=n.lastIndexOf(t);return i>0&&(n=n.substring(i+1)),n},getFileName:function(n){return _iFile._getFileAfter(n,"/")},getFileExt:function(n){return _iFile._getFileAfter(n,".")},_getObject:function(n,t){return _obj.getF(_iFile.fileF(n),t)},addPath:function(n,t,i){var r=_iFile._getObject(n,i);_iFile._setEdit(r,_fun.ModeC);_iFile.setPath(n,t,i)},deletePath:function(n,t){var i=_iFile._getObject(n,t);_iFile._setEdit(i,"D");_iFile.setPath(n,"",t)},_setEdit:function(n,t){n.data("fun",t)},isDeleted:function(n,t){var i=_iFile._getObject(n,t);return i.data("fun")=="D"},getFile:function(n,t){var r=_iFile._getObject(n,t),i=r.get(0).files;return i.length>0?i[0]:null},hasFile:function(n,t){return!_str.isEmpty(_obj.getF(_iFile.labelF(n),t).find("a").attr("href"))},rowAddFile:function(n,t,i,r,u){var f=_iFile.getFile(i,u);f!=null?n.append(r,f):_iFile.isDeleted(i,u)&&(t["_"+i]=1)},dataAddFile:function(n,t,i,r){var u=_iFile.getFile(t,r),f=u!=null;return f&&n.append(i,u),f},getEmptyFileForNew:function(n){var t=-1;return n.find("tr").each(function(n,i){var u=$(i),r;if(u.data("fun")===_fun.ModeC&&(r=u.find(":file"),r.length===0||r[0].files.length==0))return t=n,!1}),t},onChangeFile:function(n){var i=$(n),r=n.value,f=i.data("id"),t,e,u;if(_str.isEmpty(r)){_iFile.deletePath(f);return}if(t=i.data("exts").toLowerCase(),!_str.isEmpty(t)&&(e=_iFile.getFileExt(r).toLowerCase(),t=","+t+",",t.indexOf(","+e+",")<0)){_tool.msg(RB.UploadFileNotMatch);n.value="";return}if(u=i.data("max"),n.files[0].size>u*1048576){_tool.msg(_str.format(RB.UploadFileNotBig,u));n.value="";return}_iFile.addPath(f,r)}},_iHtml={encode:function(n){return $("<div/>").text(n).html()},decode:function(n){return $("<div/>").html(n).text()},encodeRow:function(n,t){for(var r,i=0;i<t.length;i++)r=t[i],n[r]=_iHtml.encode(n[r]);return n},update:function(n,t){var i="#"+n,r=t===undefined?$(i):t.find(i);r.summernote("code",r.text())},updates:function(n,t){for(var i=0;i<n.length;i++)_iHtml.update(n[i],t)}},_input={getObj:function(n,t){var i=_obj.get(n,t);return i.length==0&&(i=_obj.getD(n,t)),i},get:function(n,t){var i=_input.getObj(n,t);return _input.getO(i,t)},getO:function(n){switch(_input.getType(n)){case"check":return _iCheck.getO(n);case"radio":return _iRadio.getO(n);case"textarea":return _iTextarea.getO(n);case"select":return _iSelect.getO(n);case"read":return _iRead.getO(n);default:return n.hasClass("xd-date")?_iDate.getO(n):n.val()}},set:function(n,t,i){_input.setO(_input.getObj(n,i),t,i)},setO:function(n,t){switch(_input.getType(n)){case"check":_iCheck.setO(n,t);break;case"radio":t=t||"0";_iRadio.setOs(n,t);break;case"textarea":t=_iHtml.decode(t);n.html(t);n.val(t);break;case"select":_iSelect.setO(n,t);break;case"read":_iRead.setO(n,t);break;default:n.hasClass("xd-date")?_iDate.setO(n,t):n.val(t)}},getType:function(n){return n.data("type")},getByType:function(n,t,i){switch(t){case"check":return _iCheck.getO(n);case"radio":return _iRadio.getO(n,i);default:return n.val()}},getOld:function(n){return n.data("old")},isBound:function(n){var t=$(n);return t.find(":not(.bound)").length==0},setEdit:function(n,t,i){_obj.get(n,i).attr("readonly",!t)},setEdits:function(n,t,i){for(var r=0;r<n.length;r++)_obj.get(n[r],i).attr("readonly",!t)},exist:function(n,t){return _input.existF("#"+n,t)},existF:function(n,t){var i=t===undefined?$(n):t.find(n);return i.length>0},_onChangeSelect:function(n){for(var u,t,i="selected",f=n.options.length,r=0;r<f;r++)u=n.options[r],t=$(u),u.selected?t.hasClass(i)||t.addClass(i):t.hasClass(i)&&t.removeClass(i)},setSelect:function(n,t){$("#"+n).selectpicker("val",t)},setValue:function(n,t){var i=$("#"+n);i.length==0?console.log("no field: "+n):i.val(t)},writeMultiValue:function(n,t){var i=$("#"+n+"_tmp").val();i&&(i=i.join(t));$("#"+n).val(i)},setLabel:function(n,t){$("#"+n).text(t)},showError:function(n,t,i){n.addClass(_fun.errCls);var f="[data-id2="+t+_fun.errTail+"]",u=n.parent(),r=u.find(f);r.length==0&&(r=u.next());r.text(i);r.show()},clearFieldError:function(n,t){var i="#"+n+_fun.errTail,u=t===undefined?$(i):t.find(i),r=u.prev(),f=r.attr("id");r.removeClass(_fun.errCls)},clearFieldsError:function(){$("."+_fun.errCls).removeClass(_fun.errCls)}},_iRadio=$.extend({},_iBase,{get:function(n,t){return _iRadio.getOs(_obj.get(n,t))},getO:function(n){return n.val()},getOs:function(n){return n.filter(":checked").val()},set:function(n,t,i){_iRadio.setOs(_obj.get(n,i),t)},setO:function(n){n.prop("checked",!0)},setOs:function(n,t){n.filter("[value="+t+"]").prop("checked",!0)},setEdit:function(n,t,i){_iRadio.setEditOs(_obj.get(n,i))},setEditOs:function(n,t){n.attr("disabled",!t)},render:function(n,t,i,r,u,f,e){return t=t||"",f=f||"",e=e||"",r=r||"",t==""&&(t="&nbsp;"),_str.isEmpty(r)&&(r=1),e+=" data-id='"+n+"' name='"+n+"' value='"+r+"'",i&&(e+=" checked"),u===undefined||u||(e+=" disabled"),_str.format("<label class='xg-radio {0}'>   <input type='radio'{1}>{2}   <span><\/span><\/label>",f,e,t)}}),_iRead={get:function(n,t){return _iRead.getO(_obj.getD(n,t))},getF:function(n,t){return _iRead.getO(_obj.getF(n,t))},getO:function(n){return n.text()},set:function(n,t,i){_iRead.setO(_obj.getD(n,i),t)},setF:function(n,t,i){_iRead.setO(_obj.getF(n,i),t)},setO:function(n,t){n.text(t)}},_iSelect=$.extend({},_iBase,{getO:function(n){return n.length===0?"":n.find("option:selected").val()},setO:function(n,t){filter='option[value="'+t+'"]';var i=n.find(filter);return i.length>0?(i.prop("selected",!0),i):(n.find("option:selected").prop("selected",!1),null)},setEditO:function(n,t){n.prop("disabled",!t)},getIndex:function(n,t){return _iSelect.getIndexO(_obj.get(n,t))},getIndexO:function(n){return n.prop("selectedIndex")},getCount:function(n,t){return _iSelect.getCountO(_obj.get(n,t))},getCountO:function(n){return n.find("option").length},setIndex:function(n,t,i){_iSelect.setIndexO(_obj.get(n,i),t)},setIndexO:function(n,t){n.find("option").eq(t).prop("selected",!0)},getText:function(n,t){var i=_obj.get(n,t);return _iSelect.getTextO(i)},getTextO:function(n){return n.find("option:selected").text()},getData:function(n,t,i){return _obj.get(n,i).find("option:selected").data(t)},getDataO:function(n,t){return n.find("option:selected").data(t)},setItems:function(n,t,i){var r=_obj.get(n,i);_iSelect.setItemsO(r,t)},setItemsF:function(n,t,i){var r=_obj.getF(n,i);_iSelect.setItemsO(r,t)},setItemsO:function(n,t){if(n.find("option").remove(),t!==null)for(var i=0;i<t.length;i++)n.append($("<option><\/option>").attr("value",t[i].Id).text(t[i].Str))},getExts:function(n,t){var i=[];return _obj.get(n,t).find("option").each(function(n){var t=$(this);i[n]={Id:t.val(),Str:t.text(),Ext:t.data("ext")}}),i},setExts:function(n,t,i){var u="#"+n,f=i?i.find(u):$(u),r;if(f.find("option").remove(),t!=null)for(r=0;r<t.length;r++)f.append(_str.format("<option data-ext='{0}' value='{1}'>{2}<\/option>",t[r].Ext,t[r].Id,t[r].Str))},valuesToJson:function(n,t,i){for(var r=0;r<t.length;r++)n[t[r]]=_iSelect.get(t[r],i);return n},filterByExt:function(n,t,i,r,u){var e,s,o,f;for(u===undefined&&(u=!1),e=_obj.get(n,r),e.empty(),s=i.length,o=0;o<s;o++)f=i[o],(u===!0&&f.Ext==""||f.Ext==t)&&e.append(_str.format('<option value="{0}">{1}<\/option>',f.Id,f.Text));s>0&&_iSelect.setIndexO(e,0)}}),_iText=$.extend({},_iBase,{mask:function(n){_obj.getF("[data-mask!='']",n).each(function(){var n=$(this);n.mask(n.data("mask"))})}}),_iTextarea=$.extend({},_iBase,{getO:function(n){return n.html()},setO:function(n,t){n.html(t)}}),_json={copy:function(n,t){var t=t||{};for(var i in n)t[i]=n[i];return t},keyValuesToJson:function(n,t,i){var u,r,f;if(n===null||n.length===0)return null;for(t||(t="Key"),i||(i="Value"),u={},r=0;r<n.length;r++)f=n[r],u["f"+f[t]]=f[i];return u},toStr:function(n){return _json.isEmpty(n)?"":JSON.stringify(n)},isEmpty:function(n){return n==null||$.isEmptyObject(n)},isKeyValue:function(n){return Object.prototype.toString.call(n)==="[object Object]"},urlToJson:function(n){n.indexOf("?")>-1&&(n=n.split("?")[1]);var i=n.split("&"),t={};return i.forEach(function(n){n=n.split("=");n[0]!==""&&(t[n[0]]=decodeURIComponent(n[1]||""))}),t},strToArray:function(n){return $.parseJSON(n)},findIndex:function(n,t,i){if(n==null)return-1;for(var r=0;r<n.length;r++)if(n[r][t]==i)return r;return-1},filterRows:function(n,t,i){return n.filter(function(n){return n[t]===i})},appendRows:function(n,t){var r,i;if(n!=null&&n.length!=0)for(r=t.length,i=0;i<n.length;i++)t[r+i]=n[i]}},_leftmenu={init:function(){_leftmenu.menu=$(".xg-leftmenu");$(".xg-toggle").click(function(n){var r,t,i;n.preventDefault();r=$(this);r.next().collapse("toggle");t=r.find(".xg-arrow");i="xg-open";t.hasClass(i)?t.removeClass(i):t.addClass(i)})},onToggleMenu:function(){_leftmenu.menu.toggleClass("xg-close")}},_locale={},_log={_start:0,_now:0,info:function(n){console.log(n)},error:function(n){alert(n)},logTimeInit:function(n){_start=new Date;_now=_start;n&&console.log(n)},logTime:function(n){var t=new Date,i=n+":"+(t-_now)+"/"+(t-_start);console.log(i);_now=new Date}},_modal={show:function(n){$("#"+n).modal("show")},hide:function(n){$("#"+n).modal("hide")},showO:function(n){n.modal("show")},hideO:function(n){n.modal("hide")},showF:function(n){$(n).modal("show")},hideF:function(n){$(n).modal("hide")}},_nav={moveLeft:function(n){n.insertBefore(n.prev())},moveRight:function(n){n.insertAfter(n.next())}},_num={isBigZero:function(n,t){return isNaN(n)?!1:t||n!=="0"&&n!==0?parseInt(n)<0?!1:!0:!1},isNum:function(n){return!isNaN(n)},toBool:function(n){return n===1},rowToBool:function(n,t){for(var r,i=0;i<t.length;i++)r=t[i],n[r]=_num.toBool(n[r]);return n},addComma:function(n){n+="";x=n.split(".");x1=x[0];x2=x.length>1?"."+x[1]:"";for(var t=/(\d+)(\d{3})/;t.test(x1);)x1=x1.replace(t,"$1,$2");return x1+x2}},_obj={get:function(n,t){return _obj.getF("[name="+n+"]",t)},getById:function(n,t){return _obj.getF("#"+n,t)},getF:function(n,t){return t.find(n)},getN:function(n,t){return _obj.getF("[name="+n+"]",t)},getD:function(n,t){return _obj.getF("[data-id="+n+"]",t)},getV:function(n,t){return _obj.getF("[value="+n+"]",t)},getId:function(n){return n.length>0?n.attr("id"):""},getName:function(n){return n.length>0?n.attr("name"):""},getDid:function(n){return n.length>0?n.data("id"):""},isShow:function(n){return n.is(":visible")},isExist:function(n){return n.length>0},hasAttr:function(n){return n.attr(attr)}},_pjax={init:function(n){$(document).pjax("[data-pjax]",n,{type:"POST"})}},_prog={me:null,oriPath:"",init:function(){_prog.me=$(".xg-prog-path");_prog.oriPath=_prog.me.text()},resetPath:function(){_prog.me.text(_prog.oriPath)},setPathCreate:function(){_prog.me.text(_prog.oriPath+"-"+RB.Create)},setPathUpdate:function(){_prog.me.text(_prog.oriPath+"-"+RB.Update)}},_qrcode={set:function(n,t,i,r){return _qrcode.setO(_obj.getById(n,t),i,r)},setO:function(n,t,i){return i=i||128,new QRCode(n[0],{text:t,width:i,height:i,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.H})}},_str={colSep:"@@",isEmpty:function(n){return n===undefined||n===null||n===""},emptyToStr:function(n,t){return _str.isEmpty(n)?t:n},format:function(){for(var i,t=arguments[0],n=0;n<arguments.length-1;n++)i=new RegExp("\\{"+n+"\\}","gm"),t=t.replace(i,arguments[n+1]);return t},getCut2:function(n,t,i){var r,u;return _str.isEmpty(n)?"":(r=n.indexOf(t),r<0)?n:(u=n.indexOf(i,r+1),u<0?n.substring(r+t.length):n.substring(r+t.length,u))},toBool:function(n){return n=="1"||n==!0||n=="True"},colsToStr:function(){for(var t=arguments[0],n=1;n<arguments.length;n++)t+=_str.colSep+arguments[n];return t},trim:function(n){return $.trim(n)}},_switch={getText:function(n,t,i,r,u,f,e){var h=u?" xg-inline":"",o=f?' id="'+f+'"':"",s;return r&&(o+=" checked"),e=e?" "+e:"",s='<label class="switch{5}" style="width:{2}px;"><input{3} class="switch-input{4}" type="checkbox" /><span class="switch-label" data-on="{0}" data-off="{1}"><\/span><span class="switch-handle"><\/span><\/label>',_str.format(s,n,t,i,o,e,h)}},_tab={moveLeft:function(n){n.insertBefore(n.prev())},moveRight:function(n){n.insertAfter(n.next())}},_table={rowMoveUp:function(n){var t=$(n).closest("tr");t.insertBefore(t.prev())},rowMoveDown:function(n){var t=$(n).closest("tr");t.insertAfter(t.next())},rowFun:function(){return""+_str.format('<a href="javascript:_crud.onUpdate(\'{0}\');"><i class="icon-times" title="{0}"><\/i><\/a>',key,RB.TipUpdate)+_str.format('<a href="javascript:_table.rowMoveUp(this);"><i class="icon-up" title="{0}"><\/i><\/a>',RB.TipUpdate)+_str.format('<a href="javascript:_table.rowMoveDown(this);"><i class="icon-down" title="{0}"><\/i><\/a>',RB.TipUpdate)}},_tool={init:function(){_tool.xgAlert=$("#xgAlert");_tool.xgMsg=$("#xgMsg");_tool.xgMsg.find(".modal-footer button").text(RB.BtnYes);_tool.xgAns=$("#xgAns");_tool.xgAns.find(".xd-yes").text(RB.BtnYes);_tool.xgAns.find(".xd-no").text(RB.BtnCancel);_tool.xgArea=$("#xgArea");_tool.xgArea.find(".xd-yes").text(RB.BtnYes);_tool.xgArea.find(".xd-no").text(RB.BtnCancel)},msg:function(n,t){var i=_tool.xgMsg;i.find(".xd-msg").html(n);_modal.showO(i);_tool._fnOnMsgOk=t},ans:function(n,t,i){var r=_tool.xgAns;r.find(".xd-msg").html(n);_modal.showO(r);_tool._fnOnAnsYes=t;_tool._fnOnAnsNo=i===undefined?null:i},alert:function(n){var t=_tool.xgAlert;t.find(".xd-msg").text(n);t.fadeIn(500,function(){t.show();setTimeout(function(){_tool.onAlertClose()},5e3)})},showWait:function(){$("#xgWait").show()},hideWait:function(){$("#xgWait").hide()},showArea:function(n,t,i){var r=_tool.xgArea;r.find(".modal-title").text(n);r.find("textarea").val(t);_tool._fnOnAreaYes=i;_modal.showO(r)},onAreaYes:function(){var n=_tool.xgArea,t;_tool._fnOnAreaYes&&(_modal.hideO(n),t=n.find("textarea").val(),_tool._fnOnAreaYes(t))},onAlertClose:function(){var n=_tool.xgAlert;n.fadeOut(500,function(){n.hide()})},onAnsYes:function(){_tool._fnOnAnsYes&&(_modal.hideO(_tool.xgAns),_tool._fnOnAnsYes())},onAnsNo:function(){_tool._fnOnAnsNo&&_tool._fnOnAnsNo();_modal.hideO(_tool.xgAns)},onMsgOk:function(){_tool._fnOnMsgOk&&_tool._fnOnMsgOk();_modal.hideO(_tool.xgMsg)}},_valid={init:function(n,t){var i={ignore:"",errorElement:"span"};return t&&(i=_json.copy(t,i)),n.validate(i)},getInputBox:function(n){return $(n).closest("."+_fun.xiBorder)},reInit:function(n,t){n.removeData("validator");n.removeData("unobtrusiveValidation");_valid.init(n,t)},anyRegularsWrong:function(n,t,i){var u,r,f;if(n==null||n.length==0)return!1;for(u=!1,r=0;r<n.length;r++)f=$("#"+n[r]).val(),i.test(f)||(u=!0,_input.showError(n[r],t));return u},anyEmailsWrong:function(n,t){return _valid.anyRegularsWrong(n,t,/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)},anyAddressesWrong:function(n,t){return _valid.anyRegularsWrong(n,t,/^\d+\w*\s*(?:(?:[\-\/]?\s*)?\d*(?:\s*\d+\/\s*)?\d+)?\s+/)}},_var={emptyToValue:function(n,t){return _str.isEmpty(n)?t:n},isEmpty:function(n){return n===undefined||n===null}},_openUser={init:function(n,t){t=t||"ou";var r="#_"+t,u=$(r),i={boxId:t,filter:r,fn:n,isRows:_iText.get("_IsRows",u)==1},f={dom:_crud.dtDom,filter:!0,columns:[{data:"_Fun"},{data:"Account"},{data:"Name"},],columnDefs:[_crud.dtProp,{targets:[0],render:function(n,t,r){var u=_str.colsToStr(r.Id,r.Name,r.Account);return i.isRows?_iCheck.dtCheck0(u):_crud.dtRadio1(u)}},]},e=i.filter+" #_Table";return i.dt=_datatable.init(e,"../OpenUser/GetPage",f),i},show:function(n){_iCheck.setF(n.filter+" #_Table",!1);_modal.showF(n.filter)},onClickFind:function(n){var t=$(n.filter);_datatable.find(n.dt,null,_iText.get("Name",t))},onClickOk:function(n){var t=$(n.filter),i,r;n.isRows?(i=_iCheck.getCheckedValues(t,_iCheck.check0Id),i.length==0?_tool.msg("請先選取資料。"):(n.fn(i),_modal.hideO(t))):(r=_iRadio.get(_iCheck.Check1Id,t),r==""?_tool.msg("請先選取資料。"):(n.fn(r),_modal.hideO(t)))}},_xp={temp:{},initApp:function(){_leftmenu.init();_pjax.init(".xu-body");_tool.init();moment.locale(_fun.locale)}};